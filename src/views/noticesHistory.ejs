<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historial de Notificaciones</title>
    <%- include('partials/head') %>
</head>
<body>
    <%- include('partials/navigation') %>

    <div class="container">
        <!-- Formulario de Búsqueda y Filtro -->
        <form method="GET" action="/noticesHistory" class="mb-3">
            <div class="row">
                <div class="col-md-2">
                    <input type="text" name="machine" class="form-control" placeholder="Buscar por Equipo" value="<%= machine %>">
                </div>
                <div class="col-md-2">
                    <input type="text" name="message" class="form-control" placeholder="Buscar por Descripción" value="<%= message %>">
                </div>
                <div class="col-md-2">
                    <input type="text" name="technician" class="form-control" placeholder="Buscar por Técnico" value="<%= technician %>">
                </div>
                <div class="col-md-2">
                    <input type="date" name="startDate" class="form-control" placeholder="Fecha Inicio" value="<%= startDate %>">
                </div>
                <div class="col-md-2">
                    <input type="date" name="endDate" class="form-control" placeholder="Fecha Fin" value="<%= endDate %>">
                </div>
                <div class="col-md-2">
                    <button type="submit" class="btn btn-primary">Buscar</button>
                </div>
            </div>
        </form>

        <!-- Tabla de Notificaciones -->
        <table class="table table-striped table-sm">
            <thead>
              <tr>
                <th>#</th>
                <th>Equipo</th>
                <th>Novedad</th>
                <th>Hora registro</th>
                <th>Hora inicio</th>
                <th>Hora fin</th>
                <th>Técnico</th>
              </tr>
            </thead>
            <tbody>
              <% noticesHistory.forEach(item => { %>
                <tr>
                  <td><a href="/noticesDetail/<%= item.id %>" class="btn btn-secondary rounded-2"><%= item.id %></a></td>
                  <td><%= item.machine %></td>
                  <td><%= item.message %></td>
                  <td><%= item.regtime ? item.regtime.toLocaleString() : '' %></td>
                  <td><%= item.starttime ? item.starttime.toLocaleString() : '' %></td>
                  <td><%= item.endtime ? item.endtime.toLocaleString() : '' %></td>
                  <td><%= item.technician %></td>
                </tr>
              <% }) %>
            </tbody>
        </table>
    </div>

    <%- include('partials/footer') %>
    <%- include('partials/scripts') %>
</body>
</html>

